<!DOCTYPE html>
<html charset="UTF-8">
  <head>
    <meta name="viewport">
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrap-table.min.js"></script>
    <link rel="stylesheet" href="css/bootstrap-table.min.css">
    <link href="css/bootstrap.min.css" rel="stylesheet" title="main">
    <title>My Camper automation</title>
  </head>
  <body>
    <div class="container-fluid">
      <h1>My Camper </h1>
      <ul class="nav nav-pills" id="tab">
        <li class="active"><a href="#tab_gpio" data-toggle="pill">Telecomandi</a></li>
	<li><a href="#tab_mesures" data-toggle="pill">Mesures</a></li>
      </ul>
      <div class="tab-content">
        <div class="tab-pane fade in active" id="tab_gpio">
          <h2>GPIO</h2>
          <div class="row">
            <div class="col-xs-4 col-md-4">
              <h4 class="text-left">LED sinistra
                <div class="span badge" id="0_etat">OFF</div>
              </h4>
            </div>
            <div class="col-xs-4 col-md-4">
              <div class="button btn btn-success btn-lg" id="0_On" type="button">ON</div>
            </div>
            <div class="col-xs-4 col-md-4">
              <div class="button btn btn-danger btn-lg" id="0_Off" type="button">OFF</div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-4 col-md-4">
              <h4 class="text-left">LED destra
                <div class="span badge" id="1_etat">OFF</div>
              </h4>
            </div>
            <div class="col-xs-4 col-md-4">
              <div class="button btn btn-success btn-lg" id="1_On" type="button">ON</div>
            </div>
            <div class="col-xs-4 col-md-4">
              <div class="button btn btn-danger btn-lg" id="1_Off" type="button">OFF</div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-4 col-md-4">
              <h4 class="text-left">Ventilazione
                <div class="span badge" id="2_etat">OFF</div>
              </h4>
            </div>
            <div class="col-xs-4 col-md-4">
              <div class="button btn btn-success btn-lg" id="2_On" type="button">ON</div>
            </div>
            <div class="col-xs-4 col-md-4">
              <div class="button btn btn-danger btn-lg" id="2_Off" type="button">OFF</div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-4 col-md-4">
              <h4 class="text-left">Servizio
                <div class="span badge" id="3_etat">OFF</div>
              </h4>
            </div>
            <div class="col-xs-4 col-md-4">
              <div class="button btn btn-success btn-lg" id="3_On" type="button">ON</div>
            </div>
            <div class="col-xs-4 col-md-4">
              <div class="button btn btn-danger btn-lg" id="3_Off" type="button">OFF</div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="tab_mesures">        
          <h2>Data Monitor</h2>
          <ul class="nav nav-pills">
            <li class="active"><a href="#">
                <div class="span badge pull-right" id="temperatura">-</div> Temperatura</a></li>
            <li><a href="#">
                <div class="span badge pull-right" id="humidita">-</div> Humidit&aacute;</a></li>
            <li><a href="#">
                <div class="span badge pull-right" id="batteria">-</div> Tensione batteria</a></li>
          </ul><br>
        </div>
      </div>
      <div class="row" style="position:absolute; bottom:0; width:100%">
        <div class="col-xs-2 col-md-2"><img src="img/logo.png" width="30" height="30"></div>
        <div class="col-xs-5 col-md-5">
          <p><a href="http://www.rmap.cc">rmap.cc</a></p>
        </div>
        <div class="col-xs-5 col-md-5">
          <p><a href="http://github.com">Documentazione</a></p>
        </div>
      </div>
    </div>
    <!--script(src='js/script.js')-->
    <script>

      // Commandes sur le GPIO - GPIO change
      $('#0_On').click(function(){ setBouton('0','1'); });
      $('#0_Off').click(function(){ setBouton('0','0'); });
      $('#1_On').click(function(){ setBouton('1','1'); });
      $('#1_Off').click(function(){ setBouton('1','0'); });
      $('#2_On').click(function(){ setBouton('2','1'); });
      $('#2_Off').click(function(){ setBouton('2','0'); });
      $('#3_On').click(function(){ setBouton('3','1'); });
      $('#3_Off').click(function(){ setBouton('3','0'); });
      
      function setBouton(id, etat){
        $.post("gpio?id=" + id + "&etat=" + etat).done(function(data){
          //console.log("Retour setBouton " + JSON.stringify(data)); 
          var id_gpio = "#" + id + "_etat";
          //console.log(data);
          if ( data.success === "1" | data.success === 1 ) {
            if ( data.etat === "1" ) {
              $(id_gpio).html("ON");
            } else {
              $(id_gpio).html("OFF");
            }  
          } else {
            $(id_gpio).html('!');
          }      
        }).fail(function(err){
          console.log("err setButton " + JSON.stringify(err));
        });
      } 
      
    </script>
  </body>
</html>
